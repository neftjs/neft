{"id":"AOtE","dependencies":[{"name":"/Users/krystian/Projects/OpenSource/neft/packages/docs/editor/package.json","includedInParent":true,"mtime":1560887740812},{"name":"/Users/krystian/Projects/OpenSource/neft/node_modules/pegjs/package.json","includedInParent":true,"mtime":1560878263465},{"name":"../../utils/arrays","loc":{"line":3,"column":27},"parent":"/Users/krystian/Projects/OpenSource/neft/node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","resolved":"/Users/krystian/Projects/OpenSource/neft/node_modules/pegjs/lib/utils/arrays.js"},{"name":"../../grammar-error","loc":{"line":4,"column":27},"parent":"/Users/krystian/Projects/OpenSource/neft/node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","resolved":"/Users/krystian/Projects/OpenSource/neft/node_modules/pegjs/lib/grammar-error.js"},{"name":"../asts","loc":{"line":5,"column":27},"parent":"/Users/krystian/Projects/OpenSource/neft/node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","resolved":"/Users/krystian/Projects/OpenSource/neft/node_modules/pegjs/lib/compiler/asts.js"},{"name":"../visitor","loc":{"line":6,"column":27},"parent":"/Users/krystian/Projects/OpenSource/neft/node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","resolved":"/Users/krystian/Projects/OpenSource/neft/node_modules/pegjs/lib/compiler/visitor.js"}],"generated":{"js":"\"use strict\";var e=require(\"../../utils/arrays\"),n=require(\"../../grammar-error\"),r=require(\"../asts\"),i=require(\"../visitor\");function s(s){var u=[],o=i.build({rule:function(e){u.push(e.name),o(e.expression),u.pop(e.name)},sequence:function(n){e.every(n.elements,function(e){return o(e),!r.alwaysConsumesOnSuccess(s,e)})},rule_ref:function(i){if(e.contains(u,i.name))throw u.push(i.name),new n(\"Possible infinite loop when parsing (left recursion: \"+u.join(\" -> \")+\").\",i.location);o(r.findRule(s,i.name))}});o(s)}module.exports=s;"},"sourceMaps":{"js":{"mappings":[{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":3,"column":0},"generated":{"line":1,"column":13}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"arrays","original":{"line":3,"column":4},"generated":{"line":1,"column":17}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"require","original":{"line":3,"column":19},"generated":{"line":1,"column":19}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":3,"column":27},"generated":{"line":1,"column":27}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"GrammarError","original":{"line":4,"column":4},"generated":{"line":1,"column":49}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"require","original":{"line":4,"column":19},"generated":{"line":1,"column":51}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":4,"column":27},"generated":{"line":1,"column":59}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"asts","original":{"line":5,"column":4},"generated":{"line":1,"column":82}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"require","original":{"line":5,"column":19},"generated":{"line":1,"column":84}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":5,"column":27},"generated":{"line":1,"column":92}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"visitor","original":{"line":6,"column":4},"generated":{"line":1,"column":103}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"require","original":{"line":6,"column":19},"generated":{"line":1,"column":105}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":6,"column":27},"generated":{"line":1,"column":113}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":20,"column":0},"generated":{"line":1,"column":127}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"reportInfiniteRecursion","original":{"line":20,"column":9},"generated":{"line":1,"column":136}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"ast","original":{"line":20,"column":33},"generated":{"line":1,"column":138}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"visitedRules","original":{"line":21,"column":6},"generated":{"line":1,"column":141}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"visitedRules","original":{"line":21,"column":6},"generated":{"line":1,"column":145}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":21,"column":21},"generated":{"line":1,"column":147}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"check","original":{"line":23,"column":6},"generated":{"line":1,"column":150}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"visitor","original":{"line":23,"column":14},"generated":{"line":1,"column":152}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"build","original":{"line":23,"column":22},"generated":{"line":1,"column":154}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":23,"column":28},"generated":{"line":1,"column":160}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"rule","original":{"line":24,"column":4},"generated":{"line":1,"column":161}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":24,"column":10},"generated":{"line":1,"column":166}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":24,"column":19},"generated":{"line":1,"column":175}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"visitedRules","original":{"line":25,"column":6},"generated":{"line":1,"column":178}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"push","original":{"line":25,"column":19},"generated":{"line":1,"column":180}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":25,"column":24},"generated":{"line":1,"column":185}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"name","original":{"line":25,"column":29},"generated":{"line":1,"column":187}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"check","original":{"line":26,"column":6},"generated":{"line":1,"column":193}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":26,"column":12},"generated":{"line":1,"column":195}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"expression","original":{"line":26,"column":17},"generated":{"line":1,"column":197}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"visitedRules","original":{"line":27,"column":6},"generated":{"line":1,"column":209}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"pop","original":{"line":27,"column":19},"generated":{"line":1,"column":211}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":27,"column":23},"generated":{"line":1,"column":215}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"name","original":{"line":27,"column":28},"generated":{"line":1,"column":217}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"sequence","original":{"line":30,"column":4},"generated":{"line":1,"column":224}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":30,"column":14},"generated":{"line":1,"column":233}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":30,"column":23},"generated":{"line":1,"column":242}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"arrays","original":{"line":31,"column":6},"generated":{"line":1,"column":245}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"every","original":{"line":31,"column":13},"generated":{"line":1,"column":247}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":31,"column":19},"generated":{"line":1,"column":253}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"elements","original":{"line":31,"column":24},"generated":{"line":1,"column":255}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":31,"column":34},"generated":{"line":1,"column":264}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"element","original":{"line":31,"column":43},"generated":{"line":1,"column":273}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":34,"column":15},"generated":{"line":1,"column":276}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"check","original":{"line":32,"column":8},"generated":{"line":1,"column":283}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"element","original":{"line":32,"column":14},"generated":{"line":1,"column":285}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"asts","original":{"line":34,"column":16},"generated":{"line":1,"column":289}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"alwaysConsumesOnSuccess","original":{"line":34,"column":21},"generated":{"line":1,"column":291}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"ast","original":{"line":34,"column":45},"generated":{"line":1,"column":315}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"element","original":{"line":34,"column":50},"generated":{"line":1,"column":317}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"rule_ref","original":{"line":38,"column":4},"generated":{"line":1,"column":323}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":38,"column":14},"generated":{"line":1,"column":332}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":38,"column":23},"generated":{"line":1,"column":341}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"arrays","original":{"line":39,"column":10},"generated":{"line":1,"column":344}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"arrays","original":{"line":39,"column":10},"generated":{"line":1,"column":347}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"contains","original":{"line":39,"column":17},"generated":{"line":1,"column":349}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"visitedRules","original":{"line":39,"column":26},"generated":{"line":1,"column":358}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":39,"column":40},"generated":{"line":1,"column":360}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"name","original":{"line":39,"column":45},"generated":{"line":1,"column":362}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":42,"column":14},"generated":{"line":1,"column":368}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"visitedRules","original":{"line":40,"column":8},"generated":{"line":1,"column":374}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"push","original":{"line":40,"column":21},"generated":{"line":1,"column":376}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":40,"column":26},"generated":{"line":1,"column":381}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"name","original":{"line":40,"column":31},"generated":{"line":1,"column":383}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":42,"column":14},"generated":{"line":1,"column":389}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"GrammarError","original":{"line":42,"column":18},"generated":{"line":1,"column":393}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":43,"column":10},"generated":{"line":1,"column":395}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"visitedRules","original":{"line":44,"column":14},"generated":{"line":1,"column":451}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"join","original":{"line":44,"column":27},"generated":{"line":1,"column":453}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":44,"column":32},"generated":{"line":1,"column":458}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","original":{"line":45,"column":14},"generated":{"line":1,"column":466}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":46,"column":10},"generated":{"line":1,"column":471}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"location","original":{"line":46,"column":15},"generated":{"line":1,"column":473}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"check","original":{"line":50,"column":6},"generated":{"line":1,"column":483}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"asts","original":{"line":50,"column":12},"generated":{"line":1,"column":485}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"findRule","original":{"line":50,"column":17},"generated":{"line":1,"column":487}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"ast","original":{"line":50,"column":26},"generated":{"line":1,"column":496}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"node","original":{"line":50,"column":31},"generated":{"line":1,"column":498}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"name","original":{"line":50,"column":36},"generated":{"line":1,"column":500}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"check","original":{"line":54,"column":2},"generated":{"line":1,"column":510}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"ast","original":{"line":54,"column":8},"generated":{"line":1,"column":512}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"module","original":{"line":57,"column":0},"generated":{"line":1,"column":515}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"exports","original":{"line":57,"column":7},"generated":{"line":1,"column":522}},{"source":"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js","name":"reportInfiniteRecursion","original":{"line":57,"column":17},"generated":{"line":1,"column":530}}],"sources":{"../../../../node_modules/pegjs/lib/compiler/passes/report-infinite-recursion.js":"\"use strict\";\n\nvar arrays       = require(\"../../utils/arrays\"),\n    GrammarError = require(\"../../grammar-error\"),\n    asts         = require(\"../asts\"),\n    visitor      = require(\"../visitor\");\n\n/*\n * Reports left recursion in the grammar, which prevents infinite recursion in\n * the generated parser.\n *\n * Both direct and indirect recursion is detected. The pass also correctly\n * reports cases like this:\n *\n *   start = \"a\"? start\n *\n * In general, if a rule reference can be reached without consuming any input,\n * it can lead to left recursion.\n */\nfunction reportInfiniteRecursion(ast) {\n  var visitedRules = [];\n\n  var check = visitor.build({\n    rule: function(node) {\n      visitedRules.push(node.name);\n      check(node.expression);\n      visitedRules.pop(node.name);\n    },\n\n    sequence: function(node) {\n      arrays.every(node.elements, function(element) {\n        check(element);\n\n        return !asts.alwaysConsumesOnSuccess(ast, element);\n      });\n    },\n\n    rule_ref: function(node) {\n      if (arrays.contains(visitedRules, node.name)) {\n        visitedRules.push(node.name);\n\n        throw new GrammarError(\n          \"Possible infinite loop when parsing (left recursion: \"\n            + visitedRules.join(\" -> \")\n            + \").\",\n          node.location\n        );\n      }\n\n      check(asts.findRule(ast, node.name));\n    }\n  });\n\n  check(ast);\n}\n\nmodule.exports = reportInfiniteRecursion;\n"},"lineCount":null}},"error":null,"hash":"40cc6ea7ae8a54cbc9674284a33e839f","cacheData":{"env":{}}}